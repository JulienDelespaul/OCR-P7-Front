{"ast":null,"code":"var _jsxFileName = \"/home/julien/Desktop/ubuntu save files/Dropbox/Formation OpenClassroom/Projet 7 Front/src/components/PostsPageComponents/PostsPageAddPost.jsx\",\n    _s = $RefreshSig$();\n\nimport \"../Button/button.css\";\nimport { useState } from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport axios from \"../../Api/axios\";\nimport useAuth from \"../../hooks/useAuth\";\nimport usePostsRefresh from \"../../hooks/usePostsRefresh\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst POST_URL = \"/post\";\n\nconst PostsPageAddPost = () => {\n  _s();\n\n  const [image, setImage] = useState({\n    img: null,\n    imgUrl: null\n  });\n  const {\n    auth\n  } = useAuth();\n  const {\n    setPostId,\n    postId,\n    setRefresh\n  } = usePostsRefresh();\n\n  const HandleInput = async data => {\n    const formData = new FormData();\n    formData.append(\"image\", image.img);\n    formData.append(\"content\", data.content);\n\n    try {\n      const response = await axios.post(POST_URL, formData, {\n        headers: {\n          \"Content-Type\": \"multipart/form-data\",\n          Authorization: `Bearer ${auth.token}`\n        }\n      });\n      console.log(\"response\", response); // toggle refresh to trigger useEffect in Posts.jsx\n\n      setRefresh(true);\n      setPostId(response.data);\n      console.log(postId);\n      reset();\n      setImage({\n        img: null,\n        imgUrl: null\n      });\n    } catch (error) {\n      console.log(error);\n    }\n  };\n\n  const HandleImageSelection = e => {\n    e.preventDefault(); // display image from input\n\n    if (e.target.files && e.target.files[0]) {\n      let img = e.target.files[0];\n      let imgUrl = URL.createObjectURL(img);\n      setImage({\n        img,\n        imgUrl\n      });\n      console.log(image);\n    }\n\n    console.log(e.target.files[0]);\n  };\n\n  const HandleReset = e => {\n    e.preventDefault();\n    setImage({\n      img: null,\n      imgUrl: null\n    });\n    reset();\n  };\n\n  const {\n    register,\n    handleSubmit,\n    reset,\n    formState\n  } = useForm({\n    defaultValues: {\n      content: \"\",\n      img: \"\"\n    }\n  });\n  return /*#__PURE__*/_jsxDEV(\"form\", {\n    onSubmit: handleSubmit(HandleInput),\n    className: \"h-min  w-full text-lg flex flex-col justify-between object-top border-2 border-tertiary border-b-8 border-r-8 rounded-2xl \",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex flex-row justify-between p-2\",\n      children: [/*#__PURE__*/_jsxDEV(\"label\", {\n        className: \" pt-2 pb-1 font-bold text-base text-primary\",\n        children: \"Exprimez-vous !\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 69,\n        columnNumber: 5\n      }, this), formState.isDirty && /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"border-2 border-primary text-primary\",\n        onClick: HandleReset,\n        children: /*#__PURE__*/_jsxDEV(\"svg\", {\n          xmlns: \"http://www.w3.org/2000/svg\",\n          className: \"h-6 w-6\",\n          fill: \"none\",\n          viewBox: \"0 0 24 24\",\n          stroke: \"currentColor\",\n          children: /*#__PURE__*/_jsxDEV(\"path\", {\n            strokeLinecap: \"round\",\n            strokeLinejoin: \"round\",\n            strokeWidth: 2,\n            d: \"M6 18L18 6M6 6l12 12\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 73,\n            columnNumber: 8\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 72,\n          columnNumber: 7\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 71,\n        columnNumber: 6\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 4\n    }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n      className: \"px-2 mx-2 h-16 flex text-base text-wrap bg-secondary text-tertiary resize-none\",\n      placeholder: \"...\",\n      type: \"text\",\n      name: \"content\",\n      ...register(\"content\")\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 4\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      children: image.img && /*#__PURE__*/_jsxDEV(\"img\", {\n        src: image.imgUrl,\n        alt: \"preview\",\n        className: \" max-h-80 sm:h-96  mt-4 mx-auto object-contain rounded-2xl\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 85,\n        columnNumber: 23\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 4\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex justify-end m-2 mr-4 mb-4 text-base gap-2 \",\n      children: [/*#__PURE__*/_jsxDEV(\"label\", {\n        className: \"brutal-btn  cursor-pointer\",\n        children: [image !== null && image !== void 0 && image.img ? /*#__PURE__*/_jsxDEV(\"span\", {\n          children: \"Changer d'image\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 88,\n          columnNumber: 20\n        }, this) : /*#__PURE__*/_jsxDEV(\"span\", {\n          children: \"Ajouter une image\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 88,\n          columnNumber: 51\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"file\",\n          className: \"hidden\",\n          name: \"image\",\n          ...register(\"image\"),\n          onChange: HandleImageSelection\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 89,\n          columnNumber: 6\n        }, this), \" \"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 87,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"brutal-btn \",\n        children: \"Poster\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 5\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 4\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 64,\n    columnNumber: 3\n  }, this);\n};\n\n_s(PostsPageAddPost, \"8iD9WQX3uJ9mDXeKqCRHeR3d/Zw=\", false, function () {\n  return [useAuth, usePostsRefresh, useForm];\n});\n\n_c = PostsPageAddPost;\nexport default PostsPageAddPost;\n\nvar _c;\n\n$RefreshReg$(_c, \"PostsPageAddPost\");","map":{"version":3,"names":["useState","useForm","axios","useAuth","usePostsRefresh","POST_URL","PostsPageAddPost","image","setImage","img","imgUrl","auth","setPostId","postId","setRefresh","HandleInput","data","formData","FormData","append","content","response","post","headers","Authorization","token","console","log","reset","error","HandleImageSelection","e","preventDefault","target","files","URL","createObjectURL","HandleReset","register","handleSubmit","formState","defaultValues","isDirty"],"sources":["/home/julien/Desktop/ubuntu save files/Dropbox/Formation OpenClassroom/Projet 7 Front/src/components/PostsPageComponents/PostsPageAddPost.jsx"],"sourcesContent":["import \"../Button/button.css\";\nimport { useState } from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport axios from \"../../Api/axios\";\nimport useAuth from \"../../hooks/useAuth\";\nimport usePostsRefresh from \"../../hooks/usePostsRefresh\";\n\nconst POST_URL = \"/post\";\n\nconst PostsPageAddPost = () => {\n\tconst [image, setImage] = useState({ img: null, imgUrl: null });\n\tconst { auth } = useAuth();\n\tconst { setPostId, postId, setRefresh } = usePostsRefresh();\n\n\tconst HandleInput = async (data) => {\n\t\tconst formData = new FormData();\n\t\tformData.append(\"image\", image.img);\n\t\tformData.append(\"content\", data.content);\n\t\ttry {\n\t\t\tconst response = await axios.post(POST_URL, formData, {\n\t\t\t\theaders: {\n\t\t\t\t\t\"Content-Type\": \"multipart/form-data\",\n\t\t\t\t\tAuthorization: `Bearer ${auth.token}`,\n\t\t\t\t},\n\t\t\t});\n\t\t\tconsole.log(\"response\", response);\n\t\t\t// toggle refresh to trigger useEffect in Posts.jsx\n\t\t\tsetRefresh(true);\n\t\t\tsetPostId(response.data);\n\t\t\tconsole.log(postId);\n\t\t\treset();\n\t\t\tsetImage({ img: null, imgUrl: null });\n\t\t} catch (error) {\n\t\t\tconsole.log(error);\n\t\t}\n\t};\n\n\tconst HandleImageSelection = (e) => {\n\t\te.preventDefault();\n\t\t// display image from input\n\t\tif (e.target.files && e.target.files[0]) {\n\t\t\tlet img = e.target.files[0];\n\t\t\tlet imgUrl = URL.createObjectURL(img);\n\t\t\tsetImage({ img, imgUrl });\n\t\t\tconsole.log(image);\n\t\t}\n\t\tconsole.log(e.target.files[0]);\n\t};\n\n\tconst HandleReset = (e) => {\n\t\te.preventDefault();\n\t\tsetImage({ img: null, imgUrl: null });\n\t\treset();\n\t};\n\n\tconst { register, handleSubmit, reset, formState } = useForm({\n\t\tdefaultValues: {\n\t\t\tcontent: \"\",\n\t\t\timg: \"\",\n\t\t},\n\t});\n\n\treturn (\n\t\t<form\n\t\t\tonSubmit={handleSubmit(HandleInput)}\n\t\t\tclassName=\"h-min  w-full text-lg flex flex-col justify-between object-top border-2 border-tertiary border-b-8 border-r-8 rounded-2xl \"\n\t\t>\n\t\t\t<div className=\"flex flex-row justify-between p-2\">\n\t\t\t\t<label className=\" pt-2 pb-1 font-bold text-base text-primary\">Exprimez-vous !</label>\n\t\t\t\t{formState.isDirty && (\n\t\t\t\t\t<button className=\"border-2 border-primary text-primary\" onClick={HandleReset}>\n\t\t\t\t\t\t<svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-6 w-6\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n\t\t\t\t\t\t\t<path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t</button>\n\t\t\t\t)}\n\t\t\t</div>\n\t\t\t<textarea\n\t\t\t\tclassName=\"px-2 mx-2 h-16 flex text-base text-wrap bg-secondary text-tertiary resize-none\"\n\t\t\t\tplaceholder=\"...\"\n\t\t\t\ttype=\"text\"\n\t\t\t\tname=\"content\"\n\t\t\t\t{...register(\"content\")}\n\t\t\t/>\n\t\t\t<div>{image.img && <img src={image.imgUrl} alt=\"preview\" className=\" max-h-80 sm:h-96  mt-4 mx-auto object-contain rounded-2xl\" />}</div>\n\t\t\t<div className=\"flex justify-end m-2 mr-4 mb-4 text-base gap-2 \">\n\t\t\t\t<label className=\"brutal-btn  cursor-pointer\">\n\t\t\t\t\t{image?.img ? <span>Changer d'image</span> : <span>Ajouter une image</span>}\n\t\t\t\t\t<input type=\"file\" className=\"hidden\" name=\"image\" {...register(\"image\")} onChange={HandleImageSelection} />{\" \"}\n\t\t\t\t</label>\n\t\t\t\t<button className=\"brutal-btn \">Poster</button>\n\t\t\t</div>\n\t\t</form>\n\t);\n};\n\nexport default PostsPageAddPost;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}